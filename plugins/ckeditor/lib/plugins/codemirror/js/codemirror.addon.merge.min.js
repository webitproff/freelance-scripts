!function(n){"object"==typeof exports&&"object"==typeof module?n(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","diff_match_patch"],n):n(CodeMirror)}(function(n){function E(a,b){this.mv=a;this.type=b;this.classes="left"==b?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",
start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}function C(a){a.diffOutOfDate&&(a.diff=R(a.orig.getValue(),a.edit.getValue(),a.mv.options.ignoreWhitespace),a.chunks=S(a.diff),a.diffOutOfDate=!1,n.signal(a.edit,"updateDiff",a.diff))}function D(a,b){if(a.diffOutOfDate)a.lockScroll&&null==a.needsScrollSync&&(a.needsScrollSync=b);else{if(a.needsScrollSync=null,!a.lockScroll)return 1;
var c=+new Date,e=b?(d=a.edit,a.orig):(d=a.orig,a.edit);if(!(d.state.scrollSetBy==a&&(d.state.scrollSetAt||0)+250>c)){var g,f,h,d,k,l,m=d.getScrollInfo();if("align"==a.mv.options.connect)h=m.top;else{g=.5*m.clientHeight;f=m.top+g;l=d.lineAtHeight(f,"local");for(var p=a.chunks,x,v,n,r,t=0;t<p.length;t++){var q=p[t],u=b?q.editFrom:q.origFrom,y=b?q.editTo:q.origTo;null==v&&(l<u?(v=q.editFrom,r=q.origFrom):l<y&&(v=q.editTo,r=q.origTo));y<=l?(x=q.editTo,n=q.origTo):u<=l&&(x=q.editFrom,n=q.origFrom)}l=
{edit:{before:x,after:v},orig:{before:n,after:r}};d=T(d,b?l.edit:l.orig);l=T(e,b?l.orig:l.edit);d=(f-d.top)/(d.bot-d.top);(h=l.top-g+d*(l.bot-l.top))>m.top&&1>(k=m.top/g)?h=h*k+m.top*(1-k):(d=m.height-m.clientHeight-m.top)<g&&d<(l=e.getScrollInfo()).height-l.clientHeight-h&&1>(k=d/g)&&(h=h*k+(l.height-l.clientHeight-d)*(1-k))}return e.scrollTo(m.left,h),e.state.scrollSetAt=c,e.state.scrollSetBy=a,1}}}function T(a,b){var c=b.after;return null==c&&(c=a.lastLine()+1),{top:a.heightAtLine(b.before||0,
"local"),bot:a.heightAtLine(c,"local")}}function U(a,b,c){(a.lockScroll=b)&&0!=c&&D(a,DIFF_INSERT)&&B(a);(b?n.addClass:n.rmClass)(a.lockButton,"CodeMirror-merge-scrolllock-enabled")}function K(a,b,c){for(var e=0;e<b.length;++e){var g=b[e];if(g instanceof n.TextMarker)g.clear();else if(g.parent)for(var f=a,h=c,d=h.classLocation,k=0;k<d.length;k++)f.removeLineClass(g,d[k],h.chunk),f.removeLineClass(g,d[k],h.start),f.removeLineClass(g,d[k],h.end)}b.length=0}function V(a,b,c,e,g){var f=a.getViewport();
a.operation(function(){c.from==c.to||20<f.from-c.to||20<c.from-f.to?(K(a,c.marked,g),L(a,b,e,c.marked,f.from,f.to,g),c.from=f.from,c.to=f.to):(f.from<c.from&&(L(a,b,e,c.marked,f.from,c.from,g),c.from=f.from),f.to>c.to&&(L(a,b,e,c.marked,c.to,f.to,g),c.to=f.to))})}function M(a,b,c,e,g,f){var h=c.classLocation;b=a.getLineHandle(b);for(var d=0;d<h.length;d++)e&&a.addLineClass(b,h[d],c.chunk),g&&a.addLineClass(b,h[d],c.start),f&&a.addLineClass(b,h[d],c.end);return b}function L(a,b,c,e,g,f,h){function d(b,
c){for(var d=Math.max(g,b),k=Math.min(f,c),l=d;l<k;++l)e.push(M(a,l,h,!0,l==b,l==c-1));b==c&&d==c&&k==c&&(d?e.push(M(a,d-1,h,!1,!1,!0)):e.push(M(a,d,h,!1,!0,!1)))}for(var k=w(0,0),l=w(g,0),m=a.clipPos(w(f-1)),p=c==DIFF_DELETE?h.del:h.insert,x=0,v=!1,n=0;n<b.length;++n){var r,t,q=b[n],u=q[0],y=q[1];u==DIFF_EQUAL?(t=k.line+(W(b,n)?0:1),F(k,y),t<(r=k.line+(X(b,n)?1:0))&&(v&&(d(x,t),v=!1),x=r)):(v=!0,u==c&&(q=F(k,y,!0),t=k,u=0<((r=l).line-t.line||r.ch-t.ch)?r:t,y=q,t=0>((r=m).line-y.line||r.ch-y.ch)?
r:y,r=t,(y=u).line==r.line&&y.ch==r.ch||e.push(a.markText(u,t,{className:p})),k=q))}v&&d(x,k.line+1)}function B(a){if(a.showDifferences){var b;a.svg&&(G(a.svg),b=a.gap.offsetWidth,Y(a.svg,"width",b,"height",a.gap.offsetHeight));a.copyButtons&&G(a.copyButtons);for(var c=a.edit.getViewport(),e=a.orig.getViewport(),g=a.mv.wrap.getBoundingClientRect().top,f=g-a.edit.getScrollerElement().getBoundingClientRect().top+a.edit.getScrollInfo().top,g=g-a.orig.getScrollerElement().getBoundingClientRect().top+
a.orig.getScrollInfo().top,h=0;h<a.chunks.length;h++){var d=a.chunks[h];if(d.editFrom<=c.to&&d.editTo>=c.from&&d.origFrom<=e.to&&d.origTo>=e.from){var k=a,l=g,m=f,p=b,x="left"==k.type,v=k.orig.heightAtLine(d.origFrom,"local",!0)-l,n=void 0,r=void 0,t=void 0;k.svg&&(t=v,n=k.edit.heightAtLine(d.editFrom,"local",!0)-m,x&&(r=t,t=n,n=r),q=k.orig.heightAtLine(d.origTo,"local",!0)-l,u=k.edit.heightAtLine(d.editTo,"local",!0)-m,x&&(r=q,q=u,u=r),t=" C "+p/2+" "+n+" "+p/2+" "+t+" "+(p+2)+" "+t,u=" C "+p/2+
" "+q+" "+p/2+" "+u+" -1 "+u,Y(k.svg.appendChild(document.createElementNS("http://www.w3.org/2000/svg","path")),"d","M -1 "+n+t+" L "+(p+2)+" "+q+u+" z","class",k.classes.connect));var q=void 0,u=void 0;k.copyButtons&&(q=k.copyButtons.appendChild(z("div","left"==k.type?"⇝":"⇜","CodeMirror-merge-copy")),u=k.mv.options.allowEditingOriginals,q.title=k.edit.phrase(u?"Push to left":"Revert chunk"),q.chunk=d,q.style.top=(d.origTo>d.origFrom?v:k.edit.heightAtLine(d.editFrom,"local")-m)+"px",q.setAttribute("role",
"button"),u&&(u=k.edit.heightAtLine(d.editFrom,"local")-m,(m=k.copyButtons.appendChild(z("div","right"==k.type?"⇝":"⇜","CodeMirror-merge-copy-reverse"))).title="Push to right",m.chunk={editFrom:d.origFrom,editTo:d.origTo,origFrom:d.editFrom,origTo:d.editTo},m.style.top=u+"px","right"==k.type?m.style.left="2px":m.style.right="2px",m.setAttribute("role","button")))}}}}function Z(a,b){for(var c=0,e=0,g=0;g<b.length;g++){var f=b[g];if(f.editTo>a&&f.editFrom<=a)return null;if(f.editFrom>a)break;c=f.editTo;
e=f.origTo}return e+(a-c)}function N(a,b,c){var e=a.state.trackAlignable;a=a.firstLine();for(var g=0,f=[],h=0;;h++){for(var d=b[h],k=d?c?d.origFrom:d.editFrom:1E9;g<e.alignable.length;g+=2){var l=e.alignable[g]+1;if(!(l<=a)){if(!(l<=k))break;f.push(l)}}if(!d)break;f.push(a=c?d.origTo:d.editTo)}return f}function aa(a,b,c,e){var g=0,f=0,h=0,d=0;a:for(;;g++){var k=a[g],l=b[f];if(!k&&null==l)break;for(var m=k?k[0]:1E9,l=null==l?1E9:l;h<c.length;){var p=c[h];if(p.origFrom<=l&&p.origTo>l){f++;g--;continue a}if(p.editTo>
m){if(p.editFrom<=m)continue a;break}d+=p.origTo-p.origFrom-(p.editTo-p.editFrom);h++}m==l-d?(k[e]=l,f++):m<l-d?k[e]=m+d:((k=[l-d,null,null])[e]=l,a.splice(g,0,k),f++)}}function O(a,b){if(a.dealigned||b){if(!a.orig.curOp)return a.orig.operation(function(){O(a,b)});a.dealigned=!1;var c=a.mv.left==a?a.mv.right:a.mv.left;c&&(C(c),c.dealigned=!1);for(var e=function(a,b){var c=N(a.edit,a.chunks,!1),d=[];if(b)for(var e=0,f=0;e<b.chunks.length;e++){for(var g=b.chunks[e].editTo;f<c.length&&c[f]<g;)f++;f!=
c.length&&c[f]==g||c.splice(f++,0,g)}for(e=0;e<c.length;e++)d.push([c[e],null,null]);return aa(d,N(a.orig,a.chunks,!0),a.chunks,1),b&&aa(d,N(b.orig,b.chunks,!0),b.chunks,2),d}(a,c),g=a.mv.aligners,f=0;f<g.length;f++)g[f].clear();g.length=0;var h=[a.edit,a.orig],d=[],k=[];c&&h.push(c.orig);for(f=0;f<h.length;f++)d.push(h[f].getScrollInfo().top),k.push(-h[f].getScrollerElement().getBoundingClientRect().top);(k[0]!=k[1]||3==h.length&&k[1]!=k[2])&&ba(h,k,[0,0,0],g);for(c=0;c<e.length;c++)ba(h,k,e[c],
g);for(f=0;f<h.length;f++)h[f].scrollTo(null,d[f])}}function ba(a,b,c,e){for(var g,f=-1E8,h=[],d=0;d<a.length;d++)null!=c[d]&&(g=a[d].heightAtLine(c[d],"local")-b[d],h[d]=g,f=Math.max(f,g));for(var k,d=0;d<a.length;d++)null==c[d]||1<(k=f-h[d])&&e.push(function(a,b,c){var d=!0;b>a.lastLine()&&(b--,d=!1);var e=document.createElement("div");return e.className="CodeMirror-merge-spacer",e.style.height=c+"px",e.style.minWidth="1px",a.addLineWidget(b,e,{height:c,above:d,mergeSpacer:!0,handleMouseEvents:!0})}(a[d],
c[d],k))}function ca(a,b,c,e){var g,f,h,d;a.diffOutOfDate||(g=e.origTo>c.lastLine()?w(e.origFrom-1):w(e.origFrom,0),f=w(e.origTo,0),h=e.editTo>b.lastLine()?w(e.editFrom-1):w(e.editFrom,0),d=w(e.editTo,0),(e=a.mv.options.revertChunk)?e(a.mv,c,g,f,b,h,d):b.replaceRange(c.getRange(g,f),h,d))}function da(a){var b=a.lockButton=z("div",null,"CodeMirror-merge-scrolllock");b.setAttribute("role","button");var c=z("div",[b],"CodeMirror-merge-scrolllock-wrap");n.on(b,"click",function(){U(a,!a.lockScroll)});
b=[c];return!1!==a.mv.options.revertButtons&&(a.copyButtons=z("div",null,"CodeMirror-merge-copybuttons-"+a.type),n.on(a.copyButtons,"click",function(b){b=b.target||b.srcElement;b.chunk&&("CodeMirror-merge-copy-reverse"!=b.className?ca(a,a.edit,a.orig,b.chunk):ca(a,a.orig,a.edit,b.chunk))}),b.unshift(a.copyButtons)),"align"!=a.mv.options.connect&&((c=document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg"))&&!c.createSVGRect&&(c=null),(a.svg=c)&&b.push(c)),a.gap=z("div",
b,"CodeMirror-merge-gap")}function ea(a){return"string"==typeof a?a:a.getValue()}function R(a,b,c){a=(fa=fa||new diff_match_patch).diff_main(a,b);for(b=0;b<a.length;++b){var e=a[b];(c?/[^ \t]/.test(e[1]):e[1])?b&&a[b-1][0]==e[0]&&(a.splice(b--,1),a[b][1]+=e[1]):a.splice(b--,1)}return a}function S(a){var b=[];if(!a.length)return b;for(var c=0,e=0,g=w(0,0),f=w(0,0),h=0;h<a.length;++h){var d,k,l,m,p=a[h],n=p[0];n==DIFF_EQUAL?(l=!W(a,h)||g.line<c||f.line<e?1:0,d=g.line+l,k=f.line+l,F(g,p[1],null,f),m=
X(a,h)?1:0,l=g.line+m,m=f.line+m,d<l&&(h&&b.push({origFrom:e,origTo:k,editFrom:c,editTo:d}),c=l,e=m)):F(n==DIFF_INSERT?g:f,p[1])}return(c<=g.line||e<=f.line)&&b.push({origFrom:e,origTo:f.line+1,editFrom:c,editTo:g.line+1}),b}function X(a,b){if(b==a.length-1)return 1;var c=a[b+1][1];return!(1==c.length&&b<a.length-2||10!=c.charCodeAt(0))&&(b==a.length-2||(1<(c=a[b+2][1]).length||b==a.length-3)&&10==c.charCodeAt(0))}function W(a,b){if(0==b)return 1;var c=a[b-1][1];return 10==c.charCodeAt(c.length-1)&&
(1==b||10==(c=a[b-2][1]).charCodeAt(c.length-1))}function ga(a,b,c,e){for(var g=0;g<a.chunks.length;g++)for(var f=a.chunks[g],h=f.editFrom-b;h<f.editTo+b;h++){var d=h+c;0<=d&&d<e.length&&(e[d]=!1)}}function z(a,b,c,e){a=document.createElement(a);if(c&&(a.className=c),e&&(a.style.cssText=e),"string"==typeof b)a.appendChild(document.createTextNode(b));else if(b)for(c=0;c<b.length;++c)a.appendChild(b[c]);return a}function G(a){for(var b=a.childNodes.length;0<b;--b)a.removeChild(a.firstChild)}function Y(a){for(var b=
1;b<arguments.length;b+=2)a.setAttribute(arguments[b],arguments[b+1])}function P(a,b){for(var c in b=b||{},a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function F(a,b,c,e){a=c?w(a.line,a.ch):a;for(c=0;;){var g=b.indexOf("\n",c);if(-1==g)break;++a.line;e&&++e.line;c=g+1}return a.ch=(c?0:a.ch)+(b.length-c),e&&(e.ch=(c?0:e.ch)+(b.length-c)),a}function Q(a){this.cm=a;this.alignable=[];this.height=a.doc.height;var b=this;a.on("markerAdded",function(a,e){!e.collapsed||null!=(e=e.find(1))&&b.set(e.line,H)});
a.on("markerCleared",function(a,e,g,f){null!=f&&e.collapsed&&b.check(f,H,b.hasMarker)});a.on("markerChanged",this.signal.bind(this));a.on("lineWidgetAdded",function(a,e,g){e.mergeSpacer||(e.above?b.set(g-1,A):b.set(g,ha))});a.on("lineWidgetCleared",function(a,e,g){e.mergeSpacer||(e.above?b.check(g-1,A,b.hasWidgetBelow):b.check(g,ha,b.hasWidget))});a.on("lineWidgetChanged",this.signal.bind(this));a.on("change",function(a,e){var g=e.from.line,f=e.to.line-e.from.line,h=e.text.length-1,d=g+h;(f||h)&&
b.map(g,f,h);b.check(d,H,b.hasMarker);(f||h)&&b.check(e.from.line,H,b.hasMarker)});a.on("viewportChange",function(){b.cm.doc.height!=b.height&&b.signal()})}function ia(a,b){var c=null,e=a.state.diffViews,g=a.getCursor().line;if(e)for(var f=0;f<e.length;f++){var h=e[f],d=a==h.orig;C(h);d=(0>b?function(a,b,c){for(var d=a.length-1;0<=d;d--){var e=a[d],e=(c?e.origTo:e.editTo)-1;if(e<b)return e}}:function(a,b,c){for(var d=0;d<a.length;d++){var e=a[d],e=c?e.origFrom:e.editFrom;if(b<e)return e}})(h.chunks,
g,d);null==d||null!=c&&!(0>b?c<d:d<c)||(c=d)}if(null==c)return n.Pass;a.setCursor(c,0)}var w=n.Pos,I=!(E.prototype={constructor:E,init:function(a,b,c){this.edit=this.mv.edit;(this.edit.state.diffViews||(this.edit.state.diffViews=[])).push(this);this.orig=n(a,P({value:b,readOnly:!this.mv.options.allowEditingOriginals},P(c)));"align"==this.mv.options.connect&&(this.edit.state.trackAlignable||(this.edit.state.trackAlignable=new Q(this.edit)),this.orig.state.trackAlignable=new Q(this.orig));this.lockButton.title=
this.edit.phrase("Toggle locked scrolling");this.orig.state.diffViews=[this];a=c.chunkClassLocation||"background";"[object Array]"!=Object.prototype.toString.call(a)&&(a=[a]);this.classes.classLocation=a;this.diff=R(ea(b),ea(c.value),this.mv.options.ignoreWhitespace);this.chunks=S(this.diff);this.diffOutOfDate=this.dealigned=!1;this.needsScrollSync=null;this.showDifferences=!1!==c.showDifferences},registerEvents:function(a){var b;this.forceUpdate=function(a){function b(d){p=!(I=!0);"full"==d&&(a.svg&&
G(a.svg),a.copyButtons&&G(a.copyButtons),K(a.edit,l.marked,a.classes),K(a.orig,m.marked,a.classes),l.from=l.to=m.from=m.to=0);C(a);a.showDifferences&&(V(a.edit,a.diff,l,DIFF_INSERT,a.classes),V(a.orig,a.diff,m,DIFF_DELETE,a.classes));"align"==a.mv.options.connect&&O(a);B(a);null!=a.needsScrollSync&&D(a,a.needsScrollSync);I=!1}function g(b){I||(a.dealigned=!0,f(b))}function f(a){I||p||(clearTimeout(k),!0===a&&(p=!0),k=setTimeout(b,!0===a?20:250))}function h(b,d){a.diffOutOfDate||(a.diffOutOfDate=!0,
l.from=l.to=m.from=m.to=0);g(d.text.length-1!=d.to.line-d.from.line)}function d(){a.diffOutOfDate=!0;a.dealigned=!0;b("full")}var k,l={from:0,to:0,marked:[]},m={from:0,to:0,marked:[]},p=!1;a.edit.on("change",h);a.orig.on("change",h);a.edit.on("swapDoc",d);a.orig.on("swapDoc",d);"align"==a.mv.options.connect&&(n.on(a.edit.state.trackAlignable,"realign",g),n.on(a.orig.state.trackAlignable,"realign",g));return a.edit.on("viewportChange",function(){f(!1)}),a.orig.on("viewportChange",function(){f(!1)}),
b(),b}(this);U(this,!0,!1);(b=this).edit.on("scroll",function(){D(b,!0)&&B(b)});b.orig.on("scroll",function(){D(b,!1)&&B(b);a&&D(a,!0)&&B(a)})},setShowDifferences:function(a){(a=!1!==a)!=this.showDifferences&&(this.showDifferences=a,this.forceUpdate("full"))}}),fa,J=n.MergeView=function(a,b){function c(){m&&B(m);p&&B(p)}if(!(this instanceof J))return new J(a,b);var e,g=(this.options=b).origLeft,f=null==b.origRight?b.orig:b.origRight,h=null!=g,d=null!=f,k=1+(h?1:0)+(d?1:0),l=[],m=this.left=null,p=
this.right=null,x=this;h&&(m=this.left=new E(this,"left"),e=z("div",null,"CodeMirror-merge-pane CodeMirror-merge-left"),l.push(e),l.push(da(m)));var v,h=z("div",null,"CodeMirror-merge-pane CodeMirror-merge-editor");l.push(h);d&&(p=this.right=new E(this,"right"),l.push(da(p)),v=z("div",null,"CodeMirror-merge-pane CodeMirror-merge-right"),l.push(v));(d?v:h).className+=" CodeMirror-merge-pane-rightmost";l.push(z("div",null,null,"height: 0; clear: both;"));var A=this.wrap=a.appendChild(z("div",l,"CodeMirror-merge CodeMirror-merge-"+
k+"pane"));this.edit=n(h,P(b));m&&m.init(e,g,b);p&&p.init(v,f,b);b.collapseIdentical&&this.editor().operation(function(){!function(a,b){"number"!=typeof b&&(b=2);for(var c=[],d=a.editor(),e=d.firstLine(),f=e,g=d.lastLine();f<=g;f++)c.push(!0);a.left&&ga(a.left,b,e,c);a.right&&ga(a.right,b,e,c);for(f=0;f<c.length;f++)if(c[f]){for(var h,g=f+e,k=1;f<c.length-1&&c[f+1];f++,k++);b<k&&(h=[{line:g,cm:d}],a.left&&h.push({line:Z(g,a.left.chunks),cm:a.left.orig}),a.right&&h.push({line:Z(g,a.right.chunks),cm:a.right.orig}),
h=function(a,b){function c(){for(var a=0;a<d.length;a++)d[a].clear()}for(var d=[],e=0;e<b.length;e++){var f=b[e],f=function(a,b,c){function d(){f.clear();a.removeLineClass(b,"wrap","CodeMirror-merge-collapsed-line")}a.addLineClass(b,"wrap","CodeMirror-merge-collapsed-line");var e=document.createElement("span");e.className="CodeMirror-merge-collapsed-widget";e.title=a.phrase("Identical text collapsed. Click to expand.");var f=a.markText(w(b,0),w(c-1),{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:e,
clearOnEnter:!0});f.explicitlyCleared&&d();return n.on(e,"click",d),f.on("clear",d),n.on(e,"click",d),{mark:f,clear:d}}(f.cm,f.line,f.line+a);d.push(f);f.mark.on("clear",c)}return d[0].mark}(k,h),a.options.onCollapse&&a.options.onCollapse(a,g,k,h))}}(x,b.collapseIdentical)});"align"==b.connect&&(this.aligners=[],O(this.left||this.right,!0));m&&m.registerEvents(p);p&&p.registerEvents(m);n.on(window,"resize",c);var r=setInterval(function(){for(var a=A.parentNode;a&&a!=document.body;a=a.parentNode);
a||(clearInterval(r),n.off(window,"resize",c))},5E3)};J.prototype={constructor:J,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig},setShowDifferences:function(a){this.right&&this.right.setShowDifferences(a);this.left&&this.left.setShowDifferences(a)},rightChunks:function(){if(this.right)return C(this.right),this.right.chunks},leftChunks:function(){if(this.left)return C(this.left),this.left.chunks}};
var ha=1,A=2,H=4;Q.prototype={signal:function(){n.signal(this,"realign");this.height=this.cm.doc.height},set:function(a,b){for(var c=-1;c<this.alignable.length;c+=2){var e=this.alignable[c]-a;if(0==e)return(this.alignable[c+1]&b)==b?void 0:(this.alignable[c+1]|=b,void this.signal());if(0<e)break}this.signal();this.alignable.splice(c,0,a,b)},find:function(a){for(var b=0;b<this.alignable.length;b+=2)if(this.alignable[b]==a)return b;return-1},check:function(a,b,c){var e=this.find(a);-1!=e&&this.alignable[e+
1]&b&&(c.call(this,a)||(this.signal(),(b=this.alignable[e+1]&~b)?this.alignable[e+1]=b:this.alignable.splice(e,2)))},hasMarker:function(a){a=this.cm.getLineHandle(a);if(a.markedSpans)for(var b=0;b<a.markedSpans.length;b++)if(a.markedSpans[b].marker.collapsed&&null!=a.markedSpans[b].to)return!0;return!1},hasWidget:function(a){a=this.cm.getLineHandle(a);if(a.widgets)for(var b=0;b<a.widgets.length;b++)if(!a.widgets[b].above&&!a.widgets[b].mergeSpacer)return!0;return!1},hasWidgetBelow:function(a){if(a==
this.cm.lastLine())return!1;a=this.cm.getLineHandle(a+1);if(a.widgets)for(var b=0;b<a.widgets.length;b++)if(a.widgets[b].above&&!a.widgets[b].mergeSpacer)return!0;return!1},map:function(a,b,c){for(var e=c-b,g=a+b,f=-1,h=-1,d=0;d<this.alignable.length;d+=2){var k=this.alignable[d];k==a&&this.alignable[d+1]&A&&(f=d);k==g&&this.alignable[d+1]&A&&(h=d);k<=a||(k<g?this.alignable.splice(d--,2):this.alignable[d]+=e)}-1<f&&((b=this.alignable[f+1])==A?this.alignable.splice(f,2):this.alignable[f+1]=b&~A);-1<
h&&c&&this.set(a+c,A)}};n.commands.goNextDiff=function(a){return ia(a,1)};n.commands.goPrevDiff=function(a){return ia(a,-1)}});